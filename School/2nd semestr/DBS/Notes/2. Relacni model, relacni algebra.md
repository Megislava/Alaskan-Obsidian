Prednaska: [[hand-les03-relacni-model-a-ra.pdf]]
- presun z konceptualniho modelovani do relacniho
	- jdeme hloubeji do logicke casti

### Poznamky
#### Relacni model dat
- relace
	- atribut ("sloupec")
	- jmena **atributu** `[A1, A2,...,An]` ("jmeno sloupce")
	- **domenty** atributu `dom(Ai)` nebo `Di`
		- vsechny atributy jsou atomicke
	- usporadana **n-tice** (prvek relace) ("radek tabulky")
	- mnozina n-tic univerza domen je **relace**
	- **jmeno** relace `R`
	- **schema** relace `R(A1 : D1, A2 : D2, ..., An : Dn)`, zkracene `R(A)` ("zahlavi tabulky")
- odlisnost s tabulkama:
	- v relaci nezalezi na poradi n-tic ("radku tabulky")
	- relace neobrahuji duplicitni n-tice (jsou to mnoziny)
- schema relacni databaze (R,I)
	- R = {R1, R2, ..., Rn} mnozina relaci
	- I = mnozina integritnich omezeni
- pripustna relacni databaze
	- se schematem (R, I) je mnozina (konkretnich) relaci { R1*, R2*, ..., Rn*} takovych ze jejich n-tice vyhovuji tvrzenim v I
- klic schematu
	- klic K schematu R(A) je minimalni podmnozina atributu z A, ktera jednoznacne urci kazdou n-tici (konkretni) relace R*
	- minimalita klice
		- neezistuje takove K' ⊂ K, ktere jednoznacne urcije kazdou n-tici R(A)
	- relace muze mit nekolik (alternativnich) klicu
- integritni omezeni
	- "jake data v DB pripoustime a jake uz ne" - na urovni konceptualni i logicke
	- pomoci primarnich (PK) a cizich (FK) klicu
	- primarni klice se podtrhavani
	- cizi klic (forein key)
		- ![[Pasted image 20230214133521.png]]
	- moznosti vyjadreni a kontroly
		- deklarativni - pri vytvoreni schematu, hlidano DBMS, (PK, FK, pozdeji UK, NOT NULL a CHECK)
		- proceduralni na strane serveru
		- proceduralni na strane klienta
- databazovy dotaz
	- nad schematem S je vyraz ktery vraci odpoved se schematem T
		- definicni obor jsou vsechna uloziste se schematem S
		- obor hodnot jsou vsechny relace se schematem T
		- data v odpovedi pochazeji z DB
		- odpoved nezavisi na fyzickem ulozeni dat
	- dotazovaci jazyk
		- mnozina vsech pouzitelnych vyrazu pro konstrukci dotaz
- manipulace s relacema
	- vlozit, zrusit, dotazovani
- 

#### Relacni algebra
- model/relace ma atributy (jako sloupecky v tabulce)
	- ![[Pasted image 20230214123708.png]]
	- vrati nazev kina vekterem hrajou film ktery je natoceny pred rokem 1990: `{filmy1(rok < 1990) [jmeno_f] * predstaveni1} [nazev_k]` 
	- vrati filmy ktere jsou nekde na programu: `filmy1 < * predstaveni1`
	- pouzivaji se i mnozinove operace - prunik, sjednoceni, doplnek, kartezsky soucin
	- relacni deleni
	- ![[Pasted image 20230214124258.png]]
- relacni algebra (RA) vs jazyk SQL
	- RA je pouze dotazovaci jazyk (SQL umi delat i zmeny)
	- kazdy vyraz v RA se da prelozit na `SELECT`
- rikame **co ma byt vysledkem** - ne jak se to ma udelat
- priorita operaci
	- vyhodnocovani zleva doprava
	- pro zmenu priorit vkladame `{}`
	- selekce a projekce maji prednost pred binarnimi operacemi
- relace jsou mnoziny -> maji mnozinove operace
	- sjednoceni, prunik, rozdil, kartezsky soucin
	- tudiz existuji i v SQL
	- **minimalni mnozina operaci**: {×, selekce, projekce, →, sjednoceni , \\}
		- ostatni operace se daji vyjadrit s pomoci ostatnich operaci
- **selekce** (restrikce) relace R podle podminky ϕ
	- znacime: R(ϕ); definice: R(ϕ) =def {u | u ∈ R ∧ ϕ(u)}
		- ϕ = slozeny logicky vyraz
- **projekce** relace R na mnozine atributu C, kde C ⊆ A
	- znaceni: R\[C\]; definice: R\[C\] =def {u\[C\] | u ∈ R}
- ![[Pasted image 20230214151409.png]]
	- `telefony(jmeno='agata')[telefon]` - odkud, selekce key=value, projekce co chceme ziskat
	- ![[Pasted image 20230214172356.png]]
- **prejmenovani** atributu
	- znaceni: t -> alias
	- ![[Pasted image 20230214151724.png]]
	- ![[Pasted image 20230214172542.png]]
- **prirozene spojeni** relaci R(A) a R(B) s vysledkem T(C) (natural join)
	- znaceni: R * S; definice: R ∗ S =def {u | u\[A\] ∈ R ∧ u\[B\] ∈ S}
		- C = sjednoceni A a B; vyber n-tic pro spojeni je dan rovnosti na vsech prunikovych atributech A a B
	- ![[Pasted image 20230214151647.png]]
	- ![[Pasted image 20230214172423.png]]
- **obecne spojeni** (Θ-spojeni) R(A) s S(B) s vysledkem T(C)
	- znaceni: R\[t1Θt2\]S; definice: R\[t1Θt2\]S =def {u | u\[A\] ∈ R, u\[B\] ∈ S, u.t1Θu.t2},
		- Θ je aritmeticka nebo logicka spojka
	- ![[Pasted image 20230214153004.png]]
	- ![[Pasted image 20230214171420.png]]
- ![[Pasted image 20230214172927.png]]
	- all together
- **prirozene polospojeni**
	- **leve prirozene polospojeni**
		- znaceni: R <* S
	- **prave prirozene polospojeni**
		- znaceni: R >* S
	- ![[Pasted image 20230214174050.png]]
- **obecne polospojeni** 
	-  **leve Θ-spojeni** 
		- znaceni: R<t1Θt2] S
	-  **prave Θ-spojeni** 
		- znaceni: R\[t1Θt2 >S
	- ![[Pasted image 20230214173831.png]]
- vyuziti polospojeni
	- "syntakticka zkratka", spojeni nasledovane projekci na A (nebo B)
	- konk priklady: "kina, ktera neco hraji", "filmy, ktere se hraji"
- **antijoin**
	- doplnek - spojeni a pak negace
	- interpretace R <∗S = podmnozina n-tic z R, ktera nejsou spojitelne s zadnou n-tici z S
	- napr "kina ktera nic nehraji"
- priklady v prednasce