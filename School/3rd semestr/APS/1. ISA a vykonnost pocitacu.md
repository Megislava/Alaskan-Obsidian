Pouzite zkratky:
*IaaS (Infrastructure as a Service), SaaS (Software as a Service), IoT (Internet of Things), ALU (Arithmetic and Logical Unit)*

### ISA = Instruction Set Architecture
- abstraktni rozhrani mezi HW a nizkourovnovym SW
- zahrnuje veskere informace nezbytne k psani korektnich programu ve strojovem jazyce
- instrukcni sada, registry, organizace pameti, I/O
- = kompletni instrukcni sada procesoru vc. adresnich modu
- napr:
	- IA-32 (x86), x86-64, ARM32, ARM64, AVR, AVR32, RISC-V
- co musi byt definovane:
	- mnozina strojovych instrukci procesoru (add, sub, mult, mov,...)
	- podporovane datove typy (plovouci radova carka dle IEEE 754, cela cisla,...)
	- adresni mody (registrovy primy, primy operand, registrovy neprimy)
	- soubor registru (pocet, pouziti/vyuziti)
	- organizace pameti (adresni prostor, byte ordering, model konzistence)
- pokroky v technologii a architekture superskalarnich procesoru umoznili implementace superskalarnich CISC a vyuziti RISC technik

#### Mnozina strojovych instrukci
- rozdeleni:
	- vypocetni instrukce - aritmeticke a logicke instrukce
	- instrukce pro rizeni toku programu - skokove instrukce
	- instrukce pro pristup do pameti
	- specialni instrukce
- *jedna instrukce muze patrit do vice kategorii soucasne*
- maly pocet jednoduchych instrukci => delsi program
- velky pocet slozitejsich instrukci => kratsi kod
- CISC vs RISC
	- CISC = Complex Instruction Set Computer
		- obvykle vetsi pocet intrukci
		- instrukce ruzne delky (1B - 13B)
		- obvykle mnoho adresnich modu
	- RISC = Reduced Instruction Set Computer
		- obvykle mensi pocet instrukci
		- jedna nebo dve delky instrukci (2B, 4B)
		- obvykle mene jednodussich adresnich modu

#### (# operandu, # pametovych operandu) v ALU instrukcich
- napr:
	- ISA se zasobnikem (0,0) - 0 adresni add
	- ISA s akumulatorem (1,1) - 1 adresni add
	- ISA s universalnimi registry (2,2) - 2 adresni add
	- ISA s universalnimi registry (3,3) - 3 adresni add
- ![[Pasted image 20231002162912.png]]
- ![[Pasted image 20231002162947.png]]
- ISA s universalnimi registry
	- obsahuje sadu universalnich/architektonickych registru (GPR Set)
	- registry pouzity jako explicitni operand ALU instrukci
	- vyhody registru: rychlost, lze k nim pristupovat v libovolnem poradi, mohou uchovavat mezivysledky, lokalni promenne a paramentry
	- nevyhody: slozitejsi generatory kodu
- Load-Store architektura (3,0)
	- typicka ISA RISC procesoru
	- vyhody: pevna delka instrukce, vetsinou jednoduche kodovani instrukci, jednoduche a rychle dekodovani instrukce a cteni/zapis hodnot z/do registru, vsechny oprandy ALU instrukci jsou v registrech, vetsi flexibilita pri vyuziani registru (pocet je omezen), snadna implementace zretezeneho zpracovani (pipelining)
	- nevyhody: mensi hustota kodovani, nutnost pouzivat `load` a `store` pro nacitani a zapis z/do pameti
	- ![[Pasted image 20231002165214.png]]
- ISA (2,1) varianta
	- typicka pro CISC procestory (Intel IA-32, x86-64)
	- vyhody oproti (3,0): lepsi pristup do pameti bez pouziti `load`, lepsi hustota kodovani
	- nevyhody: zdrojovy operand je prepsany (protoze je cilovy) => potrebne dodatecne `move` instrukce pro zachovani jeho hodnoty, velka variabilita latence, komplikovanejsi pipelining
	- ![[Pasted image 20231002165234.png]]

#### Adresni mody
- napr.: primy operand, registrovy primy, prima/abstraktni adresa, registrovy neprimy, bazovy s ofsetem, bazovy/indexovany, pametovy neprimy, s post-inkrementaci, s pre-dekrementaci, skalovany,...
- nejcasteji pouzivane: bazovy s ofsetem, registrovy primy, prima/abstraktni adresa

#### Delka kodovani strojovych instrukci
1. ISA definuje instrukce ruznych delek
	- vyhody: lepsi hustota kodovani, kazdy oprand mize mit svuj specifikator adresniho kodu
	- nevyhody: slozite dekodovani
	- pr: IA-32, x86-64
1. ISA definuje jednotnou delku instrukce
	- vyhody: rychle a jednoduche, dekodovani instrukce, snazsi implementace pipeliningu, snadne nacist a paralelne dekodovat nekolik instrukci najednou
	- nevyhody: mene ortogonalni, program zabira vice pameti, implementace slozitejsich adresnich modu je slozitejsi
	- pr: MIPS32

#### Modely pristupy do pameti
1. spolecna vs. oddelena pamet dat a programu
	- Harvard architecture
		- oddelena pamet dat a instrukci (programu) => moznost soucasneho pristupu k datum a instrukcim
		- datova a programova pamet mohou mit odlisnou organizaci
	- von Neumann architecture
		- spolecna pamet pro data a instrukce, snadna manipulace s programy
		- moznost psat sebemodifikujici se programy
2. Big Endian vs. Little Endian
	- big endien - adresa slova = adresa jeho MSB (most significant byte)
	- little endien - adresa slova = adresa jeho LBS (least -||- )
	- bi-endienness
3. podpora nezarovnanych dat
	- = datovy element je zachovat je-li ulozen na adrese ktera je delitelna jeho velikosti
		- 4B slovo zarovnano pokud je adresa delitelna 4, 2B pulskovo zarovnano pokud je adresa delitelna 2, 1B slabika ....
	- nezarovnana data setri pamet, ale vyzaduji vice pristupu do pameti pri cteni/zapisu
	- IA-32 - HW podporuje nezarovnana data
	- RISC - pristup k nezarovnanym datum vygeneruje vyjimku


#### Mikroarchitektura
- ISA muze byt implementovana ruzne => mikroarchitektura
- = detailni interni organizace procesoru, vc. hlavnich funkcnich jednotek, jejich propojeni a rizeni
- hierarchie: architektura -> mikroarchitektura -> HW realizace procesoru

#### Conclusion
- ISA s akumulatorem - nejstarsi, stale vyuzivana v nekterych vestavnych aplikacich
- ISA se zasobnikem - umoznuje psani jednoduchych prekladaci, v nekterych ridicich aplikacich a v emulacnich systemech jako ISA virtualnich procesu
- ISA s universalnimi registry - dnes nejbeznejsi
- Load/Store Registr-Registr (3,0) - typicka pro RISC
- Registr-Pamet (2,1) - typicka pro CISC
- typicky RISC - Harvard, pevna delka instrukce, podporuje pouze zarovnana data


## Vykonnost
### Amdahluv zakon (AZ)
- (v puvodni forme) popisuje omezeni paralelizace vypoctu/programu na tehdenjsich multiprocesorovych pocitacich
- normalizovana casova slozitost sekvencniho provedeni programu na 1 vypocetnim jadre za jednotnovy cas
- zrychleni: ![[Pasted image 20231003134124.png]]
- ![[Pasted image 20231003135254.png]]
	- urceni horni hranice dosazitelneho zrychleni = mez saturace paralelizovatelnosti programu
- ![[Pasted image 20231003135355.png]]
- **zrychleni lze docilit vylepsenim nektere casti programu nebo pocitace**
- ![[Pasted image 20231003135445.png]]**____!**

### Mereni vykonnosti systemu
- doba prepravy - latence instrukce, doba odezvy site, pristupova doba pameti/disku
- propustonost - pocet vykonavanych instrukci za sekundu, pocet prenesenych paketu v siti za sekundu, pocet prenesenych MB/s mezi CPU a pameti
- charakteristiky k urceni vykonnosti:
	- pocet kolikrat se vykona nejaky ukon
	- cas trvani intervalu mezi dvema ukony
	- velikost daneho parametru
- => vykonnostni metrika
- nekdy je vyhodnejsi pouzit normalizovany pocet udalosti za jednotku casu ~ propustnost

#### **Vykonnostni metrika jadra procesoru ____!**
- dnes procesory obvykle maji nekolik vypocetnich jader
- ![[Pasted image 20231003141109.png]]
	- = pocet sekvencne vykonanych programu (*prg*) za jednotku casu na jadru (*core*)
- propustnost paralelniho systemu pro program (*prg*)
	- ![[Pasted image 20231003141447.png]]
	- vsechny instance programu jsou spusteny v jeden okamzik a mohou (ale nemusi) bezet paralelne
	- metrika vyjadruje schopnost daneho CPU vykonavat instance programu paralelne
	- urceni vykonnosti jakehokoli paralelniho pocitacoveho systemu

#### **Doba pro vykonani programu ____!**
- ![[Pasted image 20231003141807.png]]
	- *fCLK* je frekvence hodin vypocetniho jadra
	- zavislost *Tcore(prg)* na 3 parametrech:
		- delka hodinoveho cyklu *Tclk* (resp hodinova frekvence *fCLK*)
		- prumerny pocet hodinovych cyklu na 1 instrukci programu (*CPI(prg)*)
		- prumerny pocet vykonanych instrukci programu (*IC(prg)*)
- **upresneni doby *Tcore(prg)***:
	- ![[Pasted image 20231003142307.png]]
- ![[Pasted image 20231003142349.png]]

#### **Dalsi vykonnoctni metriky ____!**
- ![[Pasted image 20231003142447.png]]
- ![[Pasted image 20231003142509.png]]
- ![[Pasted image 20231003142637.png]]
- vykonnost CPU a spotreba energie:
	- ![[Pasted image 20231003142902.png]]
	- ![[Pasted image 20231003142929.png]]